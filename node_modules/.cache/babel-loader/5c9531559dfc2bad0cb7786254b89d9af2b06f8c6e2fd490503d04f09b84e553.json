{"ast":null,"code":"import axios from 'axios';\nconst API_URL = 'http://localhost:5000/api';\nexport class LocationTracker {\n  constructor(userId) {\n    this.userId = userId;\n    this.watchId = null;\n    this.isTracking = false;\n  }\n  startTracking() {\n    this.isTracking = true;\n    console.log('üöÄ Starting GPS tracking...');\n    navigator.geolocation.getCurrentPosition(position => {\n      console.log('‚úÖ GPS WORKING:', position.coords.latitude, position.coords.longitude);\n      this.updateLocation(position.coords.latitude, position.coords.longitude);\n      this.watchId = navigator.geolocation.watchPosition(pos => {\n        console.log('üìç GPS UPDATE:', pos.coords.latitude, pos.coords.longitude);\n        this.updateLocation(pos.coords.latitude, pos.coords.longitude);\n      }, error => console.log('Watch error:', error), {\n        enableHighAccuracy: true,\n        timeout: 30000,\n        maximumAge: 10000\n      });\n    }, error => {\n      console.log('‚ùå GPS FAILED:', error.code, error.message);\n      alert(`GPS Error: ${error.message}. Code: ${error.code}`);\n    }, {\n      enableHighAccuracy: true,\n      timeout: 30000,\n      maximumAge: 0\n    });\n  }\n  stopTracking() {\n    if (this.watchId) {\n      navigator.geolocation.clearWatch(this.watchId);\n      this.watchId = null;\n    }\n    this.isTracking = false;\n    console.log('üõë GPS tracking stopped');\n  }\n  async updateLocation(latitude, longitude) {\n    console.log('üì§ Updating location:', latitude, longitude);\n    try {\n      const token = localStorage.getItem('token');\n      const response = await axios.patch(`${API_URL}/users/${this.userId}/location`, {\n        latitude,\n        longitude,\n        address: `${latitude.toFixed(4)}, ${longitude.toFixed(4)}`\n      }, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      console.log('‚úÖ Location updated successfully');\n      if (window.driverSocket) {\n        const locationData = {\n          driverId: this.userId,\n          location: {\n            latitude,\n            longitude\n          },\n          timestamp: Date.now()\n        };\n        window.driverSocket.emit('driver-location', locationData);\n        window.driverSocket.emit('cache-driver-location', locationData);\n      }\n    } catch (error) {\n      var _error$response;\n      console.error('‚ùå Location update failed:', ((_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.data) || error.message);\n    }\n  }\n  async getCurrentLocation() {\n    return new Promise(resolve => {\n      navigator.geolocation.getCurrentPosition(position => {\n        console.log('üìç Current location:', position.coords.latitude, position.coords.longitude);\n        resolve({\n          latitude: position.coords.latitude,\n          longitude: position.coords.longitude\n        });\n      }, error => {\n        console.log('‚ùå getCurrentLocation failed:', error.message);\n        resolve({\n          latitude: 33.5731,\n          longitude: -7.5898\n        });\n      }, {\n        enableHighAccuracy: true,\n        timeout: 10000,\n        maximumAge: 0\n      });\n    });\n  }\n}\nexport default LocationTracker;","map":{"version":3,"names":["axios","API_URL","LocationTracker","constructor","userId","watchId","isTracking","startTracking","console","log","navigator","geolocation","getCurrentPosition","position","coords","latitude","longitude","updateLocation","watchPosition","pos","error","enableHighAccuracy","timeout","maximumAge","code","message","alert","stopTracking","clearWatch","token","localStorage","getItem","response","patch","address","toFixed","headers","Authorization","window","driverSocket","locationData","driverId","location","timestamp","Date","now","emit","_error$response","data","getCurrentLocation","Promise","resolve"],"sources":["C:/Users/LENOVO LEGION 7/delivery-connect/frontend/src/utils/locationTracker.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_URL = 'http://localhost:5000/api';\n\nexport class LocationTracker {\n  constructor(userId) {\n    this.userId = userId;\n    this.watchId = null;\n    this.isTracking = false;\n  }\n\n  startTracking() {\n    this.isTracking = true;\n    console.log('üöÄ Starting GPS tracking...');\n    \n    navigator.geolocation.getCurrentPosition(\n      (position) => {\n        console.log('‚úÖ GPS WORKING:', position.coords.latitude, position.coords.longitude);\n        this.updateLocation(position.coords.latitude, position.coords.longitude);\n        \n        this.watchId = navigator.geolocation.watchPosition(\n          (pos) => {\n            console.log('üìç GPS UPDATE:', pos.coords.latitude, pos.coords.longitude);\n            this.updateLocation(pos.coords.latitude, pos.coords.longitude);\n          },\n          (error) => console.log('Watch error:', error),\n          { enableHighAccuracy: true, timeout: 30000, maximumAge: 10000 }\n        );\n      },\n      (error) => {\n        console.log('‚ùå GPS FAILED:', error.code, error.message);\n        alert(`GPS Error: ${error.message}. Code: ${error.code}`);\n      },\n      { enableHighAccuracy: true, timeout: 30000, maximumAge: 0 }\n    );\n  }\n\n  stopTracking() {\n    if (this.watchId) {\n      navigator.geolocation.clearWatch(this.watchId);\n      this.watchId = null;\n    }\n    this.isTracking = false;\n    console.log('üõë GPS tracking stopped');\n  }\n\n  async updateLocation(latitude, longitude) {\n    console.log('üì§ Updating location:', latitude, longitude);\n    try {\n      const token = localStorage.getItem('token');\n      const response = await axios.patch(`${API_URL}/users/${this.userId}/location`, {\n        latitude,\n        longitude,\n        address: `${latitude.toFixed(4)}, ${longitude.toFixed(4)}`\n      }, {\n        headers: { Authorization: `Bearer ${token}` }\n      });\n      console.log('‚úÖ Location updated successfully');\n      \n      if (window.driverSocket) {\n        const locationData = {\n          driverId: this.userId,\n          location: { latitude, longitude },\n          timestamp: Date.now()\n        };\n        window.driverSocket.emit('driver-location', locationData);\n        window.driverSocket.emit('cache-driver-location', locationData);\n      }\n    } catch (error) {\n      console.error('‚ùå Location update failed:', error.response?.data || error.message);\n    }\n  }\n\n  async getCurrentLocation() {\n    return new Promise((resolve) => {\n      navigator.geolocation.getCurrentPosition(\n        (position) => {\n          console.log('üìç Current location:', position.coords.latitude, position.coords.longitude);\n          resolve({\n            latitude: position.coords.latitude,\n            longitude: position.coords.longitude\n          });\n        },\n        (error) => {\n          console.log('‚ùå getCurrentLocation failed:', error.message);\n          resolve({ latitude: 33.5731, longitude: -7.5898 });\n        },\n        { enableHighAccuracy: true, timeout: 10000, maximumAge: 0 }\n      );\n    });\n  }\n\n\n}\n\nexport default LocationTracker;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}